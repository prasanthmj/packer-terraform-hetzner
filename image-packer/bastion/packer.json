{
    "variables": {
        "hcloud_token": "{{env `HCLOUD_TOKEN`}}",
        "bastion_user_name":"userb",
        "bastion_user_key_path":"~/.ssh/id_rsa.pub"
    },
    "builders": [
      {
        "type": "hcloud",
        "token": "{{user `hcloud_token`}}",
        "image": "ubuntu-20.04",
        "location": "nbg1",
        "server_type": "cx11",
        "ssh_username": "root",
        "snapshot_name": "Bastion Snapshot image - ubuntu",
        "snapshot_labels": {
          "name":"bastion_node_image"
        }
      }
    ],
    
    "provisioners": [
        {
          "type": "ansible",
          "playbook_file": "../ansible/bastion.yaml",
          "ansible_env_vars": [ "ANSIBLE_HOST_KEY_CHECKING=False"],
          "extra_arguments":["-vv",
             "--extra-vars", 
             "deploy_user_name={{user `bastion_user_name`}} deploy_user_key_path={{user `bastion_user_key_path`}}"
            ]
        }
    ]
}